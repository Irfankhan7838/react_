<?php
session_start();

if (!isset($_SESSION['user_id'])) {
	header('location:login.php');
die();
}
include '../include/connection.php';
include '../include/global-function.php';
include_once '../security-check.php';

?>
<!doctype html>
<html lang="en">
<head>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>


  <?php include 'head.php';?>

  	<?php include 'header.php';?> 	

	<title>Add treatment</title>
	<style type="text/css">
		.container {
		  margin: 50px auto;
		}

		.card {
		  margin: 0 auto;
		  width: 100%;
		  /*max-width: 1000PX;*/
		}

		table {
		  margin-top: 20px;
		}

		th {
		  text-align: center;
		}

		.modal-dialog {
		  max-width: 90%;
		}
	/*	#editpatientModal{

		}*/
		.patient_details_div{
	        margin-top: 3rem!important;
		}

		#treatment {
		  max-height: 300px;
		  overflow-y: auto;
		}
		#add_treatment_modal .modal-dialog{
			max-width: 50%;
		}
		#add_payment_modal .modal-dialog{
			max-width: 50%;
		}
		.table_max_width td{
    		max-width: 30%;
		}
	</style>
</head>
<?php
$treatment_name = array('Fillings','Root canal therapy ','Crowns','Bridges','Dentures','Braces');
$treatment_id = array('1','2','3','4','5','6','7','8');
?>

<body>


	<div class="container-fluid patient_details_div">
	  <div class="row justify-content-center">
	    <div class="col-md-12">
	      <div class="">
	      	<div class="card-body table-bordered  mt-4 mb-4 ml-1 mr-1 row">

	      		<div class="col-4">

	      			
	      			<div id="revenueChart"></div>
	      		</div>
	      		<div class="col-4">
	      			
	      			<div id="patientChart"></div>
	      		</div>
	      		<div class="col-4">

	      		
	      			<div id="paymentChart"></div>
	      		</div>

				
			</div>
	        <div class="card-body table-bordered">

	        	<div class="form-group ">
	        		<button class="btn btn-primary btn-sm float-right mr-3 mb-3" onclick="open_add_patient_modal()">Add Patient</button>    	

	        	</div>
	        	<div class="container-fluid">
	        		<div class="row m-0 w-100">
		        		<div class="col-lg-4 ">
		        			<table class="table table-striped table-bordered  mt-4">
		        				<span class="mb-0 text-bold"><strong>Amount Due Report</strong></span>
		        			
		        			    <thead style="line-height: 0.5;">
		        			    	
					              <tr>
					              	<th>Sr.</th>
					                <th>Name</th>
					                <th>Amount Due</th>			                
					              </tr>
					            </thead>
					            <tbody style="line-height: 0.5;">
					            	<?php 
					            	

						            	$amount_due_sql = "SELECT P_id, P_Name,((SELECT COALESCE(SUM(T_cost), 0) AS treat_cost FROM Treatment WHERE T_patient_id = Patient.P_id AND T_status = '0') - (SELECT COALESCE(SUM(Pay_payment), 0) AS Payment_amt FROM Payment WHERE Pay_patient_id = Patient.P_id AND Pay_status = '0') ) AS dues FROM Patient HAVING dues != 0 ORDER BY dues DESC";
										$amount_due_result = sqlQuery($amount_due_sql,"select");
										$sr =1;
										while ($row = mysqli_fetch_assoc($amount_due_result)) {
											echo "<tr><td>".$sr."</td>
									            	<td>".$row['P_Name']."</td>
									            	<td>".$row['dues']."</td></tr>";
									            	$sr++;
										}
										
					            	?>
					            	
					            </tbody>
		        			</table>
		        		</div>
		        		<div class="col-lg-8">
			        		<div id="all_patient_div"></div>
		        		</div>

	        		</div>
	        	</div>        		        

	        </div>

	      </div>
	    </div>
	  </div>
	</div>


	<!-- Edit Modal -->
	<div class="modal blur " style="background: #00000082;" id="editpatientModal" tabindex="-1" aria-hidden="true" >
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="editpatientLabel">Edit Patient Information</h5>
	        <button type="button" class="close" onclick="close_add_details_modal()">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <ul class="nav nav-tabs" role="tablist">
	        	<li class="nav-item">
	            <a class="nav-link active" data-toggle="tab" href="#overview" id="overview_tab">Overview</a>
	          </li>
	          <li class="nav-item">
	            <a class="nav-link " data-toggle="tab" href="#treatment" id="treatment_tab">Treatment</a>
	          </li>
	          <li class="nav-item">
	            <a class="nav-link" data-toggle="tab" href="#payment" id="Payment_tab">Payment</a>
	          </li>
	        </ul>
	        <div class="tab-content" style="max-height: 500px; overflow-x: auto;">

	        	<div id="overview" class="tab-pane fade show active mt-2">
	        	<div class="row m-3">
	        		<div class="col-2"><b>Total Treatment:</b> <span id="total_treatment"></span></div>
	        		<div class="col-4"><b>Total Treatment Cost:</b> Rs. <span id="total_treatment_cost"></span></div>
	      			<div class="col-3"><b>Total Payment: </b>Rs. <span id="total_payment"></span></div>
	      			<div class="col-3"><b>Total Due: </b>Rs. <span id="total_total_due"></span></div>
	      			
	      		</div>

	          		<div id="overview_list"></div>
	          		
				 <!-- overview Tab Content Goes Here -->	            				    
	            </div>

	          <div id="treatment" class="tab-pane fade show mt-2">
	          	<button class="btn btn-primary float-right mb-1" onclick="add_treatment_modal()">Add Treatment</button>

	          	<div id="treatment_list"></div>
				<!-- Treatment Tab Content Goes Here -->
	            
				    
	          </div>
	          <div id="payment" class="tab-pane fade mt-2">
	          	<button class="btn btn-primary float-right mb-1" onclick="add_payment_modal()">Add Payment</button>
	          	<div id="payment_list"></div>

	            <!-- Payment Tab Content Goes Here -->


	            
	          </div>
	        </div>
	      </div>
	      <div class="modal-footer">
	       
	      </div>
	    </div>
	  </div>
	</div>


	<!-- //add treatment -->
	<div id="add_treatment_modal" class="modal blur " style="background: #00000082;"  tabindex="-1" aria-hidden="true" >
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="">Add-Edit treatment</h5>
	        <button type="button" class="close" onclick="close_add_treatment_modal()">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	            <div id="" class="tab-pane fade show active">
					<div class="centered-form mt-2">
					  <form id="add_treatment_form" class="send_user_email">

					  	<input type="hidden" name="patient_id" id="patient_id" >	
					    <div class="form-group">
					      <label for="treatment_name">Treatment name</label>
					      <select  name="treatment_name" class="form-control"  id="treatment_name">
					      	<option value ="">Treatment Name</option>
					      	<?php
					      	foreach ($treatment_name as $key => $value) {
					      		echo "<option> $value</option>";
					      	}
					      	?>
					      	
					       </select>       
					      <p id="treatment_nameError" class="error-msg"></p>
					    </div>
					    <div class="form-group">
					    	<label for="appointment_date">Date</label>
					      <input type="datetime-local" class="form-control" name="appointment_date"  id="appointment_date">
					      <p id="appointment_dateError" class="error-msg"></p>
					      
					    </div>

					    <div class="form-group">
						<label for="treatment_cost">Treatment cost</label>
					      <input type="number" class="form-control" name="treatment_cost" placeholder="Enter Treatment Cost" id="treatment_cost">
					      <p id="treatment_costError" class="error-msg"></p>
					    </div>					   
					    
					    <input type="hidden" name="action" value="add_treatment">			
					    <input type="hidden" name="treatment_id" id="treatment_id" >			
					    <input type="submit" value="Save" name="add_treatment" class="btn btn-primary mt-2" id="add_treatment">
					    <p id="treatment_error" class="error-msg"></p>
					    <p class="success-msg" id="treatment_success"></p>
					  </form>
					</div>				    
	            </div>
	      </div>
	      <div class="modal-footer">
	       
	      </div>
	    </div>
	  </div>
	</div>


	<!-- //add payment -->
	<div id="add_payment_modal" class="modal blur " style="background: #00000082;"  tabindex="-1" aria-hidden="true" >
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="">Add-Edit Payment</h5>
	        <button type="button" class="close" onclick="close_add_payment_modal()">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div class="centered-form mt-2">
			    <form id="add_payment_form" class="send_user_email">

				    <div class="form-group">
				    	<label for="payment_input">Amount</label>
				      <input type="number" class="form-control" name="payment"  id="payment_input" placeholder="Enter amount">
				      <p id="paymentError" class="error-msg"></p>
				      
				    </div>	
				    <div class="form-group">
				    	<label for="Payment_datetime">Payment datetime</label>
				      <input type="datetime-local" class="form-control" name="Payment_datetime"  id="Payment_datetime" >
				      <p id="Payment_datetimeError" class="error-msg"></p>
				      
				    </div>	
				     <div class="form-group">
				     <label for="Payment_method">Payment Method</label>
				      <select  name="Payment_method" class="form-control"  id="Payment_method">
				      	<option value ="">Payment Method</option>
				      	<option value ="UPI">UPI</option>
				      	<option value ="Debit card">Debit card</option>
				      	<option value ="Credit card">Credit card</option>
				      	<option value ="Cash">Cash </option>
				      	<option value ="Paytm">Paytm</option>				      	      	
				       </select> 
				      <p id="Payment_methodError" class="error-msg"></p>
				      
				    </div>			   
				    
				    <input type="hidden" name="action" value="add_payment">			
				    <input type="hidden" name="payment_id" id="payment_id" value="">			
				    <input type="hidden" name="payment_patient_id" value="" id="payment_patient_id">			
				    <input type="submit" value="Save" name="add_payment" class="btn btn-primary mt-2" id="add_payment">
				    <p id="add_payment_error" class="error-msg"></p>
				    <p class="success-msg" id="add_payment_success"></p>
				</form>
			</div>


	      </div>
	      <div class="modal-footer">
	       
	      </div>
	    </div>
	  </div>
	</div>

	<!-- //add patient -->
	<div id="add_patient_modal" class="modal blur " style="background: #00000082;"  tabindex="-1" aria-hidden="true" >
	  <div class="modal-dialog" style="max-width: 50%;" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="">Add Patient</h5>
	        <button type="button" class="close" onclick="close_add_patient_modal()">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div class="centered-form mt-2">
		        <form id="add_patient" class="send_user_email" >
	              <div class="row mt-3">
	                <div class="col">
	                  <input type="text" class="alphaOnlyWithSpaces form-control inpuuts" name="Name"  placeholder="Name*" id="patient_Name" required>
	                  <p id="patient_Name_error" style="display:none;position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                <div class="col">
	                  <input type="text" class="form-control inpuuts" placeholder="Email*" id="patient_Email" name="email">
	                  <p id="patient_Email_error" style="display:none;position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	              <div class="row mt-4">
	                <div class="col">
	                  <input type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..?)\../g, '$1');"  class="form-control inpuuts" placeholder="Phone Number*" id="patient_Phone" name="phone_number" maxlength ="10">
	                <p id="patient_Phone_error" style="display:none;position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                 <div class="col">
	                  <input type="date" class="form-control inpuuts" max="<?php echo date('Y-m-d'); ?>" placeholder="DOB*" id="patient_DOB" name="dob">
	                  <p id="patient_DOB_error" style="display:none;position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	              <div class="row mt-4">
	                 <div class="col">
	                  <input type="text" class="form-control inpuuts" class="addressonly" placeholder="Address" id="Address" name="Address">
	                  <p id="patient_Address_error" style="display:none;position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                <div class="col">
	                 <select class="form-control inpuuts" name="relation" id="patient_relation">
	                 	<option value="Self">Self</option>
	                 	<option value="Spouse">Spouse</option>
	                 	<option value="Child">Child</option>
	                 	<option value="Parent">Parent</option>
	                 	<option value="Others">Others</option>            	
	                 </select>
	                  <p id="patient_relation_error" style="display:none;position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	              <div class="row mt-4">
	              	 <div class="col">
		                 <select class="form-control inpuuts" name="patient_source" id="patient_source">
		                 	<option value=" ">Select Patient source</option>
		                 	<option value="Patient Reference">Patient Reference</option>
		                 	<option value="Family & Friends">Family & Friends</option>
		                 	<option value="Online">Online</option>
		                 	<option value="Social">Social</option>
		                 	<option value="WalkIn">WalkIn</option>   
		                 	<option value="Other">Other</option>   
   	
		                  </select>
		                  <p id="patient_source_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                <div class="col">
	                  <textarea class="form-control inpuuts textarea" id="patient_Messsage" rows="3" placeholder="Treatment plan" name="Comment"></textarea>
	                  <p id="patient_Messsage_error" style="display:none;position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	                <p style="color:green" id="msg"></p>
	              <button type="button" class="btn_submit btn btn-primary" onclick="Addpatient()" id="Addpatient_button">Add Now</button>
	              
	            

	              <input type="hidden" name="action" value="add_patient"> 
	            </form>
			</div>

	      </div>
	      <div class="modal-footer">
	       
	      </div>
	    </div>
	  </div>
	</div>	

	<!-- //update patient -->
	<div id="update_patient_modal" class="modal blur " style="background: #00000082;"  tabindex="-1" aria-hidden="true" >
	  <div class="modal-dialog" style="max-width: 50%;" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="">Update Patient</h5>
	        <button type="button" class="close" onclick="close_update_patient_modal()">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div class="centered-form mt-2">
		        <form id="update_patient" class="send_user_email" >
	              <div class="row mt-3">
	                <div class="col">
	                  <input type="text" class="alphaOnlyWithSpaces form-control inpuuts" name="UdtName"  placeholder="Name*" id="Udtpatient_Name" required>
	                  <p id="Udtpatient_Name_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                <div class="col">
	                  <input type="text" class="form-control inpuuts" placeholder="Email*" id="Udtpatient_Email" name="Udtemail">
	                  <p id="Udtpatient_Email_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	              <div class="row mt-4">
	                <div class="col">
	                  <input type="text" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..?)\../g, '$1');"  class="form-control inpuuts" placeholder="Phone Number*" id="Udtpatient_Phone" name="Udtphone_number" maxlength ="10">
	                <p id="Udtpatient_Phone_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                 <div class="col">
	                  <input type="date" class="form-control inpuuts" placeholder="DOB*" max="<?php echo date('Y-m-d'); ?>" id="Udtpatient_DOB" name="Udtdob">
	                  <p id="Udtpatient_DOB_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	              <div class="row mt-4">
	                 <div class="col">
	                  <input type="text" class="form-control inpuuts" class="addressonly" placeholder="Address" id="UdtAddress" name="UdtAddress">
	                  <p id="Udtpatient_Address_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                <div class="col">
	                 <select class="form-control inpuuts" name="Udtrelation" id="Udtpatient_relation">
	                 	<option value="Self">Self</option>
	                 	<option value="Spouse">Spouse</option>
	                 	<option value="Child">Child</option>
	                 	<option value="Parent">Parent</option>
	                 	<option value="Others">Others</option>            	
	                 </select>
	                  <p id="Udtpatient_relation_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	              <div class="row mt-4">
	                <div class="col">
	                  <textarea class="form-control inpuuts textarea" id="Udtpatient_Messsage" rows="3" placeholder="Treatment plan" name="UdtComment"></textarea>
	                  <p id="Udtpatient_Messsage_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	                <div class="col">
		                 <select class="form-control inpuuts" name="Udtpatient_source" id="Udtpatient_source">
		                 	
		                 	<option value="">Select Patient Reference</option>
		                 	<option value="Family & Friends">Family & Friends</option>
		                 	<option value="Online">Online</option>
		                 	<option value="Social">Social</option>
		                 	<option value="WalkIn">WalkIn</option>
		                 	<option value="Other">Other</option>        
          	
		                  </select>
		                  <p id="Udtpatient_source_error" style="position:absolute;color:red;font-size: 12px;margin-bottom: 0px;"></p>
	                </div>
	              </div>
	                <p style="color:green" id="Udtmsg"></p>
	              <button type="button" class="btn_submit btn btn-primary" onclick="updatepatient()" id="Udtpatient_button">Update Now</button>
	              
	            

	              <input type="hidden" name="action" value="updt_patient_detail"> 
	              <input type="hidden" name="updpatient_id" id="updpatient_id" value="1"> 
	            </form>
			</div>

	      </div>
	      <div class="modal-footer">
	       
	      </div>
	    </div>
	  </div>
	</div>	




</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
<script type="text/javascript">

	$('#patient_page_option').change(function(){
		 var url = $(this).val();
        window.location.href = url;
	
	})

	function close_add_payment_modal(){
	   $('#add_payment_modal').hide();
	}

	function add_payment_modal(){
		$('#add_payment_form')[0].reset(true);
		$('#payment_id').val('');
	 	$('#add_payment_modal').show();
	}

	function close_add_treatment_modal(){
	   $('#add_treatment_modal').hide();
	}

	function add_treatment_modal(treatmentid=''){
		$('#add_treatment_form')[0].reset(true);
		$('#treatment_id').val('');
		
		 $('#add_treatment_modal').show();
	}

	function edit_treatment_modal(treatmentid=''){
		if (treatmentid != '') {
			
			$('#treatment_id').val(treatmentid);
			$.ajax({
				url:"patient_webservice.php",
				type:"post",
				dataType:'json',
		      	data:{treatmentid:treatmentid,action:"get_single_treatment_data"} ,					
				success:function(res){
					if (res.code == 1) {	
						$('#treatment_name').val(res.data.T_treatment_name);
						$('#appointment_date').val(res.data.T_appointment_datetime);
						$('#treatment_cost').val(res.data.T_cost);						
						 $('#add_treatment_modal').show();

					}else{
						
					}
				
				}
			})
			
			
		}
	}
	
	function edit_payment_modal(paymentid=''){
		if (paymentid != '') {
			
			$('#payment_id').val(paymentid);

			$.ajax({
				url:"patient_webservice.php",
				type:"post",
				dataType:'json',
		      	data:{paymentid:paymentid,action:"get_single_payment_data"} ,					
				success:function(res){
					if (res.code == 1) {	
						$('#payment_input').val(res.data.Pay_payment);
						$('#Payment_datetime').val(res.data.Pay_datetime);
						$('#Payment_method').val(res.data.Pay_method);								
						 $('#add_payment_modal').show();

					}else{
						
					}
				
				}
			})
			
			
		}
	}

	function delete_payment_detail(paymentid=''){

		if (paymentid != '') {
			var conf = confirm('Do you really want to delete this payment');
			if (conf) {
				$.ajax({
					url:"patient_webservice.php",
					type:"post",
					dataType:'json',
			      	data:{paymentid:paymentid,action:"remove_payment"} ,					
					success:function(res){
						if (res.code == 1) {
							$('#delete_res_' + paymentid).text('Deleted');
							$('#delete_icon_' + paymentid).hide();
						
							

						}else{
							
						}
					
					}
				})	
			}

		}
	}

	function delete_treatment_detail(treatmentid=''){
		if (treatmentid != '') {
			var conf = confirm('Do you really want to delete this treatment');
			if (conf) {
				$.ajax({
					url:"patient_webservice.php",
					type:"post",
					dataType:'json',
			      	data:{treatmentid:treatmentid,action:"remove_treatment"} ,					
					success:function(res){
						if (res.code == 1) {
							
							$('#delete_res_' + treatmentid).text('Deleted');
							$('#delete_icon_' + treatmentid).hide();

						}else{
							
						}
					
					}
				})
			}
		}

	}


	function close_add_details_modal(patient_id){
		$('#editpatientModal').hide();
	}



	$(document).ready(function(){
		$(document).on('change', '#treatment_page_option', function(){
			
			get_patient_treatment($('#patient_id').val());
		});

		$(document).on('change', '#payment_page_option', function(){
			
			get_patient_payment($('#patient_id').val());
		});

	})

	//getting all patient data
	function get_all_patient(page='',Search=''){
		var Page = page ;	
		var search = Search ;	

		$.ajax({
	 		url:"patient_webservice.php",
	 		type:"post",
	 		dataType:'json',
	      	data:{action:"get_all_patient",page:Page,search:search} ,	
	      	success: function(res){
	      		if (res.code == 1) {
	      			
	      			$('#all_patient_div').html(res.data);
	      			$('#search_patient').val(search);
	      		}else{

	      		}     		    		
	   		 }

		})

	}


	$(document).ready(function(){
		get_all_patient();

	})

    $(document).on('click','#search_patient_btn',function(){
		var search = $('#search_patient').val();
		
		get_all_patient('',search);

		return false;
	})

	$(document).on('change','#patient_page_option',function(){
		var  Page = $('#patient_page_option').val();
		
		get_all_patient(Page);
	})


	function open_add_details_modal(patient_id){
		$('#patient_id').val(patient_id);
		$('#payment_patient_id').val(patient_id);

		$('#treatment_list').html('');
		$('#payment_list').html('');


		get_patient_overview(patient_id);

		get_patient_treatment(patient_id);

        get_patient_payment(patient_id);

		$('#editpatientModal').show();
	}

	function open_add_patient_modal(){
		$('#add_patient').trigger('reset');
		$('#add_patient_modal').show();
	}
	function close_add_patient_modal(){
		$('#add_patient_modal').hide();
	}

	function open_update_patient_modal(){
		$('#update_patient').trigger('reset');
		$('#updpatient_id').val($('#patient_id').val());
		$('#Udtpatient_Name').val($('#span_P_Name').text());
		$('#Udtpatient_Email').val($('#span_P_Email').text());
		$('#Udtpatient_Phone').val($('#span_P_Phone').text());
		$('#Udtpatient_DOB').val($('#span_P_DOB').text());
		$('#Udtpatient_relation').val($('#span_P_relation').text());
		$('#UdtAddress').val($('#span_P_Address').text());
		$('#Udtpatient_Messsage').val($('#span_P_Comment').text());
		$('#Udtpatient_source').val($('#span_P_patient_source').text());
		
		
		$('#update_patient_modal').show();
	}

	function close_update_patient_modal(){
		$('#update_patient_modal').hide();
	}
	function updatepatient(){ 
        
          
           $('#Udtpatient_Name_error').css({display:'block', color:'red'}).empty();

           $('#Udtpatient_Email_error').css({display:'block', color:'red'}).empty();
           $('#Udtpatient_Phone_error').css({display:'block', color:'red'}).empty();
           $('#Udtpatient_Messsage_error').css({display:'block', color:'red'}).empty();
           $('#Udtpatient_DOB_error').css({display:'block', color:'red'}).empty();
           $('#Udtpatient_Address_error').css({display:'block', color:'red'}).empty();
           $('#Udtpatient_relation_error').css({display:'block', color:'red'}).empty();
           $('#Udtpatient_source_error').css({display:'block', color:'red'}).empty();
           
           var fname= $('#Udtpatient_Name').val();
          
			var nameRegex = /^[a-zA-Z\s]+(?: [a-zA-Z\s]+)*$/;
           if(fname=='')
           {
            $('#Udtpatient_Name_error').html("Please Enter Name");
              $('#Udtpatient_Name').focus();
            return false;

           }else if (!nameRegex.test(fname)) {
			        $('#Udtpatient_Name_error').html("Please Enter valid Name");
			         $('#Udtpatient_Name').focus();
			         return false;
			} else {
			         $('#Udtpatient_Name_error').html(" ");	      
			}
           
          		

           var email= $('#Udtpatient_Email').val();
           if(email=='')
           {
            $('#Udtpatient_Email_error').html("Please Enter Emailid");
              $('#Udtpatient_Email').focus();
            return false;


           }
           if(!email.match(/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/)) {
             $('#Udtpatient_Email_error').html("Invalid Email");
              $('#Udtpatient_Email').focus();
              return false;
             }

             var phone_number_regex = /^[6-9]\d{9}$/;
             var phone= $('#Udtpatient_Phone').val();
              if(phone=='')
           {
            $('#Udtpatient_Phone_error').html("Please Enter Phone No");
              $('#Udtpatient_Phone').focus();
            return false;

           }

            if (!phone_number_regex.test(phone))
               {
              $('#Udtpatient_Phone_error').html("Please Enter valid phone no");
              $('#Udtpatient_Phone').focus();
            return false;
                  } 



            var DOB= $('#Udtpatient_DOB').val();
            if(DOB=='')
           {
            $('#Udtpatient_DOB_error').html("Please Enter DOB");
              $('#Udtpatient_DOB').focus();
            return false;

           }


           var Address= $('#UdtAddress').val();
           if(Address=='')
           {
            $('#Udtpatient_Address_error').html("Please Enter Address");
              $('#UdtAddress').focus();
            return false;

           }


          var subject= $('#Udtpatient_Messsage').val();
           if(subject=='')
           {
            $('#Udtpatient_Messsage_error').html("Please Enter Message");
              $('#Udtpatient_Messsage').focus();
            return false;

           }


          var relation= $('#Udtpatient_relation').val();
           if(relation=='')
           {
            $('#Udtpatient_relation_error').html("Please select relation");
              $('#Udtpatient_relation').focus();
            return false;

           }


           var patient_source= $('#Udtpatient_source').val();
        
           if(patient_source.length < 3)
           {
            $('#Udtpatient_source_error').html("Please select patient source");
              $('#Udtpatient_source').focus();
            return false;

           }

           var formdata = new FormData($('#update_patient')[0]);     
            $.ajax({
              	url:"patient_webservice.php",
              	type:"post",
              	processData: false,
                contentType: false,
                data: formdata,         
              	success:function(res){
             	 	var obj=JSON.parse(res);
              
	                if(obj.status=="fail"){
	                 
	                  $('#Udtmsg').html(`${obj.msg[prop]}`);
	            
	             
	                }
	                if(obj.status=="success"){
	                  $('#Udtmsg').html(obj.msg);
	                    	$('#Udtadd_patient').trigger('reset'); 	                    	
	                    	get_all_patient();     	
	                }

                    setTimeout(function() {
					    $('#Udtmsg').html('');
					    $('#update_patient_modal').hide(); 
					}, 3000);
              } 
          })
    }



	function get_patient_treatment(patient_id){
		var Page = 0 ;
	 	Page = $('#treatment_page_option').val();
		$.ajax({
			url:"patient_webservice.php",
			type:"post",
			dataType:'json',
	      	data:{patient_id:patient_id,action:"get_patient_treatment",page:Page} ,					
			success:function(res){
				if (res.code == 1) {
					$('#treatment_list').html(res.data);

				}else{
					$('#treatment_list').html(res.msg);
				}
			
			}
		})
	}

	function get_patient_payment(patient_id){
		var Page = 0 ;
		Page = $('#payment_page_option').val();
		$.ajax({
			url:"patient_webservice.php",
			type:"post",
			dataType:'json',
	      	data:{patient_id:patient_id,action:"get_patient_payment",page:Page} ,					
			success:function(res){
				if (res.code == 1) {

					$('#payment_list').html(res.data);

				}else{
					$('#payment_list').html(res.msg);
				}
			
			}
		})
	}

	function get_patient_overview(patient_id){
		$.ajax({
			url:"patient_webservice.php",
			type:"post",
			dataType:'json',
	      	data:{patient_id:patient_id,action:"get_patient"} ,					
			success:function(res){
				if (res.code == 1) {
								
					$('#overview_list').html(res.data);
					$('#total_payment').html(res.total_data.total_payment);
					$('#total_treatment').html(res.total_data.total_treatment);
					$('#total_treatment_cost').html(res.total_data.total_treatment_cost);
					$('#total_total_due').html(res.total_data.total_due);

				}else{
					$('#treatment_error').text(res.msg);
				}
			
			}
		})
	}



	function Addpatient(){ 
        
          var phone_number_regex = /^[6-9]\d{9}$/;
           $('#patient_Name_error').css({display:'block', color:'red'}).empty();

           $('#patient_Email_error').css({display:'block', color:'red'}).empty();
           $('#patient_Phone_error').css({display:'block', color:'red'}).empty();
           $('#patient_Messsage_error').css({display:'block', color:'red'}).empty();
           $('#patient_DOB_error').css({display:'block', color:'red'}).empty();
           $('#patient_Address_error').css({display:'block', color:'red'}).empty();
           $('#patient_relation_error').css({display:'block', color:'red'}).empty();
           
           var fname= $('#patient_Name').val();
          
			var nameRegex = /^[a-zA-Z\s]+(?: [a-zA-Z\s]+)*$/;
           if(fname=='')
           {
            $('#patient_Name_error').html("Please Enter Name");
              $('#patient_Name').focus();
            return false;

            }else if (!nameRegex.test(fname)) {
			        $('#patient_Name_error').html("Please Enter Name");
			         $('#patient_Name').focus();
			         return false;
			} else {
			         $('#patient_Name_error').html(" ");	      
			}



           
           var email= $('#patient_Email').val();
           if(email=='')
           {
            $('#patient_Email_error').html("Please Enter Emailid");
              $('#patient_Email').focus();
            return false;

           }
           if(!email.match(/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/)) {
             $('#patient_Email_error').html("Invalid Email");
              $('#patient_Email').focus();
              return false;
             }


             var phone= $('#patient_Phone').val();
              if(phone=='')
           {
            $('#patient_Phone_error').html("Please Enter Phone No");
              $('#patient_Phone').focus();
            return false;

           }
            if (!phone_number_regex.test(phone))
               {
              $('#patient_Phone_error').html("Please Enter valid phone no");
              $('#patient_Phone').focus();
            return false;
                  } 

			var dobRegex = /^\d{4}-\d{2}-\d{2}$/;
            var DOB= $('#patient_DOB').val();
            if(DOB=='')
           {
            $('#patient_DOB_error').html("Please Enter DOB");
              $('#patient_DOB').focus();
            return false;

           } 
		    else if (!dobRegex.test(DOB)) {
		        $('#patient_DOB_error').text('Please enter a valid date of birth in the format YYYY-MM-DD.');
		         return false;
		    } else {
		        $('#patient_DOB').html('');
		    }


           var Address= $('#Address').val();
           if(Address=='')
           {
            $('#patient_Address_error').html("Please Enter Address");
              $('#Address').focus();
            return false;

           }

          var relation= $('#patient_relation').val();
           if(subject=='')
           {
            $('#patient_relation_error').html("Please select relation");
              $('#patient_relation').focus();
            return false;

           }
            var patient_source= $('#patient_source').val();
           if(patient_source.length < 3)
           {
            $('#patient_source_error').html("Please select patient source");
              $('#patient_source').focus();
            return false;

           }

           var subject= $('#patient_Messsage').val();
           if(subject=='')
           {
            $('#patient_Messsage_error').html("Please Enter Message");
              $('#patient_Messsage').focus();
            return false;

           }

           var formdata = new FormData($('#add_patient')[0]);     
            $.ajax({
              	url:"patient_webservice.php",
              	type:"post",
              	processData: false,
                contentType: false,
                data: formdata,         
              	success:function(res){
             	 	var obj=JSON.parse(res);
              
	                if(obj.status=="fail"){
	             		$('#msg').html('<span style="color:red;">' + obj.msg + '</span>');
	             		console.log(obj.msg);
	                }
	                if(obj.status=="success"){
	                  $('#msg').html(obj.msg);
	                    	$('#add_patient').trigger('reset'); 	                    	
	                    	get_all_patient();     	
	                }

                    setTimeout(function() {
					    $('#msg').html('');
					    $('#add_patient_modal').hide(); 
					}, 3000);
              } 
          })
    }

	$(document).ready(function(){
		$('#Payment_tab').click(function(){
			$('#editpatientLabel').text('Edit Patient Payment');
		})
			
		
		$('#treatment_tab').click(function(){
			$('#editpatientLabel').text('Edit Patient Treatment');
		})

		$('#overview_tab').click(function(){
			$('#editpatientLabel').text('Edit Patient Details');
		})
	})

	

	$(document).ready(function(){

		$('#add_treatment').click(function(event){
			event.preventDefault();

			var treatment_name = $('#treatment_name').val();
		
		    if (treatment_name.length < 1) {

		        $('#treatment_nameError').text('Please select treatment name.').addClass('text-danger').show();
		    } else {
		        $('#treatment_nameError').hide();		      
		    }
	    

		    var appointment_date = $('#appointment_date').val();
			var datetimeRegex = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})$/;
			if (!datetimeRegex.test(appointment_date)) {
			    $('#appointment_dateError').text('Please enter a valid appointment date in the format YYYY-MM-DDTHH:MM.').addClass('text-danger').show();
			} else {
			    $('#appointment_dateError').hide();
			}

		    var amount = $('#treatment_cost').val();
			var amountRegex = /^\d+(\.\d{1,2})?$/;

			if (!amountRegex.test(amount)) {
			    $('#treatment_costError').text('Please enter a valid amount.').addClass('text-danger').show();
			} else {
			    $('#treatment_costError').hide();
			}
    	    
    
		    // continue with form submission if there are no errors
		    if ($('#appointment_dateError').is(':hidden') && $('#treatment_nameError').is(':hidden') && $('#treatment_costError').is(':hidden')) {
		    	var formdata = new FormData($('#add_treatment_form')[0]);			
				$.ajax({
					url:"patient_webservice.php",
					type:"post",
					processData: false,
			      	contentType: false,
			      	data: formdata,	
			      	dataType: "json", 				
					success:function(res){
						if(res.code == 1){					
							$('#add_treatment_form')[0].reset(true);

							$('#treatment_id').val('');
							$('#treatment_success').html(res.msg);
							get_patient_treatment($('#patient_id').val());
							setTimeout(function(){
							    $('#treatment_success').html('');
							    get_patient_overview($('#patient_id').val());
							    
	 							 $('#add_treatment_modal').hide();
							}, 2000);

						}else{
							$('#treatment_error').text(res.msg);
							setTimeout(function(){
							    $('#treatment_error').text('');
							}, 2000);
							
						}

					}
				})
		       
		    }
						
		})


		$('#add_payment').click(function(event){
			event.preventDefault();  


		    var payment = $('#payment_input').val();

			if (payment.length < 1) {
			    $('#paymentError').text('Please enter a valid payment.').addClass('text-danger').show();
			} else {
			    $('#paymentError').hide();
			}



			var paymentmethod = $('#Payment_method').val();

			if (!/^[a-zA-Z\s]+(?: [a-zA-Z\s]+)*$/.test(paymentmethod) || paymentmethod.length < 1) {
			    $('#Payment_methodError').text('Please select payment method.').addClass('text-danger').show();
			} else {
			    $('#Payment_methodError').hide();
			}

		    var Payment_datetime = $('#Payment_datetime').val(); 
			var datetimeRegex = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2})$/;
			if (!datetimeRegex.test(Payment_datetime)) {
			    $('#Payment_datetimeError').text('Please enter a valid payment date in the format YYYY-MM-DDTHH:MM.').addClass('text-danger').show();
			} else {
			    $('#Payment_datetimeError').hide();
			}


		    // continue with form submission if there are no errors
		    if ($('#Payment_methodError').is(':hidden') &&  $('#paymentError').is(':hidden')) {
		    	var formdata = new FormData($('#add_payment_form')[0]);			
				$.ajax({
					url:"patient_webservice.php",
					type:"post",
					processData: false,
			      	contentType: false,
			      	data: formdata,		
			      	dataType: "json", 			
					success:function(res){
						if(res.code == 1){					
							$('#add_payment_form')[0].reset(true);
							$('#payment_id').val('');
							$('#add_payment_success').html(res.msg);

       						get_patient_payment($('#patient_id').val());

       						setTimeout(function(){
							   $('#add_payment_success').html('');
							    get_patient_overview($('#patient_id').val());
							    $('#add_payment_modal').hide();
							}, 2000);
							
						}else{
							$('#add_payment_error').text(res.msg);
							setTimeout(function(){
							   $('#add_payment_error').text('');
							}, 2000);
							
						}

					}
				})
		       
		    }
						
		})		
	})





</script>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">

	  google.charts.load('current', {packages: ['corechart', 'bar']});
  	  google.charts.setOnLoadCallback(drawpaymentChart);
  	  google.charts.setOnLoadCallback(drawrevenueChart);
  	  google.charts.setOnLoadCallback(drawpatientChart);



		<?php
			 $revenueChartsql = "SELECT DATE_FORMAT(`T_appointment_datetime`, '%m') AS month, sum(T_cost) AS total_revenue FROM fab32dental.Treatment WHERE T_status = '0' and T_appointment_datetime >= DATE_SUB(NOW(), INTERVAL 12 MONTH) GROUP BY month";

			$revenue_result = sqlQuery($revenueChartsql,"select");
			
			// Storing results in array
			$revenues = array();
			while ($row = mysqli_fetch_assoc($revenue_result)) {
			    $revenues[$row['month']] = $row['total_revenue'];
			}

			$revenueyValues = array_fill(0, 12, 0);

			foreach ($revenues as $month => $total_revenue) {
			    $index = (int)$month - 1; 
			    $revenueyValues[$index] = (int)$total_revenue;
			}


			$revenueyValuesString = implode(",", $revenueyValues);


  		?>
	function drawrevenueChart() {
	    var revenuexValues = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "July", "Aug", "Sep", "Oct", "Nov", "Dec"];
	    var revenueyValues = [<?php echo $revenueyValuesString; ?>];
		var colors = ["#FF6384", "#36A2EB", "#FFCE56", "#7CB342", "#8E24AA", "#00BFA5", "#FF5722", "#673AB7", "#CDDC39", "#F44336", "#03A9F4", "#FF9800"];
	    var data = google.visualization.arrayToDataTable([
	      ['Month', 'Revenue', { role: 'style' }],
	      ['Jan', revenueyValues[0],colors[0]],
	      ['Feb', revenueyValues[1],colors[1]],
	      ['Mar', revenueyValues[2],colors[2]],
	      ['Apr', revenueyValues[3],colors[3]],
	      ['May', revenueyValues[4],colors[4]],
	      ['Jun', revenueyValues[5],colors[5]],
	      ['July',revenueyValues[6],colors[6]],
	      ['Aug', revenueyValues[7],colors[7]],
	      ['Sep', revenueyValues[8],colors[8]],
	      ['Oct', revenueyValues[9],colors[9]],
	      ['Nov', revenueyValues[10],colors[10]],
	      ['Dec', revenueyValues[11],colors[11]]
	    ]);

		var view = new google.visualization.DataView(data);
		view.setColumns([0, 1,
           { calc: "stringify",
             sourceColumn: 1,
             type: "string",
             role: "annotation" },2
        ]);

	  	var options = {
	        title: "Revenue of last 12 months",
	        width: 400,
	        height: 200,
	        bar: {groupWidth: "95%"},
	        legend: { position: "none" },
        };

		var chart = new google.visualization.ColumnChart(document.getElementById("revenueChart"));
		chart.draw(view, options);
	}

		<?php
			$paymentChartsql = "SELECT DATE_FORMAT(Pay_datetime, '%m') AS month, SUM(Pay_payment) AS total_payment FROM Payment
			WHERE Pay_status = '0' and Pay_datetime >= DATE_SUB(NOW(), INTERVAL 12 MONTH)
			GROUP BY month";

		$payment_result = sqlQuery($paymentChartsql,"select");
		
		// Storing results in array
		$payments = array();
		while ($row = mysqli_fetch_assoc($payment_result)) {
		    $payments[$row['month']] = $row['total_payment'];
		}


		$paymentyValues = array_fill(0, 12, 0);

		foreach ($payments as $month => $total_payment) {
		    $index = (int)$month - 1; 
		    $paymentyValues[$index] = (int)$total_payment;
		}


		$paymentyValuesString = implode(",", $paymentyValues);


		?>

	function drawpaymentChart() {
	    var paymentxValues = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "July", "Aug", "Sep", "Oct", "Nov", "Dec"];
	    var paymentyValues = [<?php echo $paymentyValuesString; ?>];
	    var colors = ["#FF6384", "#36A2EB", "#FFCE56", "#7CB342", "#8E24AA", "#00BFA5", "#FF5722", "#673AB7", "#CDDC39", "#F44336", "#03A9F4", "#FF9800"];

	    var data = google.visualization.arrayToDataTable([
	      ['Month', 'Payment', { role: 'style' }],
	      ['Jan', paymentyValues[0],colors[0]],
	      ['Feb', paymentyValues[1],colors[1]],
	      ['Mar', paymentyValues[2],colors[2]],
	      ['Apr', paymentyValues[3],colors[3]],
	      ['May', paymentyValues[4],colors[4]],
	      ['Jun', paymentyValues[5],colors[5]],
	      ['July', paymentyValues[6],colors[6]],
	      ['Aug', paymentyValues[7],colors[7]],
	      ['Sep', paymentyValues[8],colors[8]],
	      ['Oct', paymentyValues[9],colors[9]],
	      ['Nov', paymentyValues[10],colors[10]],
	      ['Dec', paymentyValues[11],colors[11]]
	    ]);

		var view = new google.visualization.DataView(data);
		view.setColumns([0, 1,
           { calc: "stringify",
             sourceColumn: 1,
             type: "string",
             role: "annotation" },2
        ]);

	  	 var options = {
	        title: "Payment of last 12 months",
	        width: 400,
	        height: 200,
	        bar: {groupWidth: "95%"},
	        legend: { position: "none" },
	      };

		var chart = new google.visualization.ColumnChart(document.getElementById("paymentChart"));
		chart.draw(view, options);
	}


  		<?php
			 $patientChartsql = "SELECT DATE_FORMAT(`P_Timestamp`, '%m') AS month, count(*) AS total_Patient FROM Patient WHERE P_Timestamp >= DATE_SUB(NOW(), INTERVAL 12 MONTH) GROUP BY month";

			$patient_result = sqlQuery($patientChartsql,"select");
			
			// Storing results in array
			$patients = array();
			while ($row = mysqli_fetch_assoc($patient_result)) {
			    $patients[$row['month']] = $row['total_Patient'];
			}


			$patientyValues = array_fill(0, 12, 0);

			foreach ($patients as $month => $total_patient) {
			    $index = (int)$month - 1; 
			    $patientyValues[$index] = (int)$total_patient;
			}

			// Convert array to string for use in JavaScript
			$patientyValuesString = implode(",", $patientyValues);


  		?>
	function drawpatientChart() {
	  var patientxValues = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "July", "Aug", "Sep", "Oct", "Nov", "Dec"];
	  var patientyValues = [<?php echo $patientyValuesString; ?>];
	  var colors = ["#FF6384", "#36A2EB", "#FFCE56", "#7CB342", "#8E24AA", "#00BFA5", "#FF5722", "#673AB7", "#CDDC39", "#F44336", "#03A9F4", "#FF9800"];

	  var data = google.visualization.arrayToDataTable([    ['Month', 'Patient', { role: 'style' }],
	    ['Jan', patientyValues[0], colors[0]],
	    ['Feb', patientyValues[1], colors[1]],
	    ['Mar', patientyValues[2], colors[2]],
	    ['Apr', patientyValues[3], colors[3]],
	    ['May', patientyValues[4], colors[4]],
	    ['Jun', patientyValues[5], colors[5]],
	    ['July', patientyValues[6], colors[6]],
	    ['Aug', patientyValues[7], colors[7]],
	    ['Sep', patientyValues[8], colors[8]],
	    ['Oct', patientyValues[9], colors[9]],
	    ['Nov', patientyValues[10], colors[10]],
	    ['Dec', patientyValues[11], colors[11]],
	  ]);

	  var view = new google.visualization.DataView(data);
	     view.setColumns([0, 1,
	           { calc: "stringify",
	             sourceColumn: 1,
	             type: "string",
	             role: "annotation" },
	           2]);

	  // 	var options = {
		 //    chartArea: {
		 //      left: 60,
		 //      right: 0,
		 //      top: 4,
		 //      width: '100%',
		 //      height: '90%'
		 //    },
		 //    legend: {
		 //      position: "none"
		 //    },
		 //    annotations: {
		 //      alwaysOutside: true,
		 //      highContrast: false,
		 //      textStyle: {
		 //        fontSize: 16,
		 //        bold: true,
		 //        italic: true,
		 //        // The color of the text.
		 //        color: '#000000',

		 //        // The color of the text outline.
		 //        auraColor: '#f5f5f5',
		 //        letterSpacing: '0.016em',
		 //        // The transparency of the text.
		 //        opacity: 1
		 //      }
		 //    },
		 //    vAxis: {
		 //      gridlines: {
		 //        color: 'transparent'
		 //      }
		 //    },
		 //    hAxis: {
		 //      title: 'Month'
		 //    }
	 	// };
	 	var options = {
	       title: "Patient of last 12 months",
	        width: 400,
	        height: 200,
	        bar: {groupWidth: "95%"},
	        legend: { position: "none" },
	      };
	  
	  var chart = new google.visualization.ColumnChart(document.getElementById("patientChart"));
	  chart.draw(view, options);
	}


</script>